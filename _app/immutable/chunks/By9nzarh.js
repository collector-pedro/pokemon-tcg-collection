import{q as E,v as N,w as m,x as w,y as I,z as p,n as T,A as D,B,C as Y,D as x,o as F,E as C,F as U,H as y,G as H,I as k,J as q,K as O,L as z,M as G,P as Z,g as A,N as $,O as J,Q as K,R as Q,S as V,b as W,l as X,T as j,U as ee,f as te,V as se,W as ae,X as re,Y as ie,Z as ne}from"./CPteCSAX.js";class fe{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#r=!0;constructor(e,a=!0){this.anchor=e,this.#r=a}#i=()=>{var e=E;if(this.#t.has(e)){var a=this.#t.get(e),t=this.#s.get(a);if(t)N(t),this.#a.delete(a);else{var r=this.#e.get(a);r&&(this.#s.set(a,r.effect),this.#e.delete(a),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),t=r.effect)}for(const[i,f]of this.#t){if(this.#t.delete(i),i===e)break;const s=this.#e.get(f);s&&(m(s.effect),this.#e.delete(f))}for(const[i,f]of this.#s){if(i===a||this.#a.has(i))continue;const s=()=>{if(Array.from(this.#t.values()).includes(i)){var o=document.createDocumentFragment();B(f,o),o.append(I()),this.#e.set(i,{effect:f,fragment:o})}else m(f);this.#a.delete(i),this.#s.delete(i)};this.#r||!t?(this.#a.add(i),w(f,s,!1)):s()}}};#n=e=>{this.#t.delete(e);const a=Array.from(this.#t.values());for(const[t,r]of this.#e)a.includes(t)||(m(r.effect),this.#e.delete(t))};ensure(e,a){var t=E,r=Y();if(a&&!this.#s.has(e)&&!this.#e.has(e))if(r){var i=document.createDocumentFragment(),f=I();i.append(f),this.#e.set(e,{effect:p(()=>a(f)),fragment:i})}else this.#s.set(e,p(()=>a(this.anchor)));if(this.#t.set(t,e),r){for(const[s,c]of this.#s)s===e?t.unskip_effect(c):t.skip_effect(c);for(const[s,c]of this.#e)s===e?t.unskip_effect(c.effect):t.skip_effect(c.effect);t.oncommit(this.#i),t.ondiscard(this.#n)}else T&&(this.anchor=D),this.#i()}}function oe(n,e,a=!1){var t;T&&(t=D,F());var r=new fe(n),i=a?C:0;function f(s,c){if(T){var o=U(t),h;if(o===y?h=0:o===H?h=!1:h=parseInt(o.substring(1)),s!==h){var v=k();q(v),r.anchor=v,O(!1),r.ensure(s,c),O(!0);return}}r.ensure(s,c)}x(()=>{var s=!1;e((c,o=0)=>{s=!0,f(o,c)}),s||f(!1,null)},i)}let g=!1;function ce(n){var e=g;try{return g=!1,[n(),g]}finally{g=e}}function he(n,e,a,t){var r=!X||(a&j)!==0,i=(a&V)!==0,f=(a&ae)!==0,s=t,c=!0,o=()=>(c&&(c=!1,s=f?W(t):t),s),h;if(i){var v=ie in n||ne in n;h=z(n,e)?.set??(v&&e in n?u=>n[e]=u:void 0)}var d,P=!1;i?[d,P]=ce(()=>n[e]):d=n[e],d===void 0&&t!==void 0&&(d=o(),h&&(r&&G(),h(d)));var _;if(r?_=()=>{var u=n[e];return u===void 0?o():(c=!0,u)}:_=()=>{var u=n[e];return u!==void 0&&(s=void 0),u===void 0?s:u},r&&(a&Z)===0)return _;if(h){var L=n.$$legacy;return(function(u,b){return arguments.length>0?((!r||!b||L||P)&&h(b?_():u),u):_()})}var S=!1,l=((a&ee)!==0?te:se)(()=>(S=!1,_()));i&&A(l);var M=K;return(function(u,b){if(arguments.length>0){const R=b?A(l):r&&i?$(u):u;return J(l,R),S=!0,s!==void 0&&(s=R),u}return re&&S||(M.f&Q)!==0?l.v:A(l)})}export{fe as B,oe as i,he as p};
